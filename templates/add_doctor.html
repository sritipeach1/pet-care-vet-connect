{% extends "base.html" %}
{% block content %}

<h1 class="text-lg font-semibold text-pink-600 mb-1">Add Doctor</h1>
<p class="text-sm text-gray-500 mb-4">
  Fill in the details to add a doctor to your clinic dashboard.
</p>

<form method="post"
      onsubmit="event.preventDefault(); openDoctorSaveModal(this);"
      class="space-y-3 max-w-xl">

  <div>
    <label class="block text-sm font-medium text-gray-700 mb-1">Doctor Name</label>
    <input type="text" name="name" required
           class="w-full border border-pink-100 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-pink-300 focus:border-pink-300">
  </div>

  <div>
    <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
    <input type="email" name="email" required
           class="w-full border border-pink-100 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-pink-300 focus:border-pink-300">
  </div>

  <div>
    <label class="block text-sm font-medium text-gray-700 mb-1">Base Fee (TK)</label>
    <input type="number" name="base_fee" required
           class="w-full border border-pink-100 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-pink-300 focus:border-pink-300">
  </div>

  <div>
    <label class="block text-sm font-medium text-gray-700 mb-1">Qualifications</label>
    <input type="text" name="qualifications" required
           class="w-full border border-pink-100 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-pink-300 focus:border-pink-300">
  </div>

  <hr class="my-3">

  <h3 class="text-sm font-semibold text-gray-800 mb-1">Weekly Slots</h3>
  <p class="text-xs text-gray-500 mb-2">
    Tick the days you work and choose a start and end time.
  </p>

  <div class="overflow-x-auto">
    <table class="w-full text-xs border border-gray-100 rounded-lg">
      <thead class="bg-gray-50">
      <tr>
        <th class="px-2 py-1 text-left w-10"></th>
        <th class="px-2 py-1 text-left">Day</th>
        <th class="px-2 py-1 text-left">From</th>
        <th class="px-2 py-1 text-left">To</th>
      </tr>
      </thead>
      <tbody>
      {% set days = [
          ('sat', 'Saturday'),
          ('sun', 'Sunday'),
          ('mon', 'Monday'),
          ('tue', 'Tuesday'),
          ('wed', 'Wednesday'),
          ('thu', 'Thursday'),
          ('fri', 'Friday')
      ] %}
      {% for key, label in days %}
      <tr class="odd:bg-white even:bg-gray-50">
        <td class="px-2 py-1">
          <input type="checkbox" name="{{ key }}_enabled" class="accent-pink-500">
        </td>
        <td class="px-2 py-1">{{ label }}</td>
        <td class="px-2 py-1">
          <input type="time" name="{{ key }}_start"
                 class="border border-gray-200 rounded px-2 py-1 text-xs w-full">
        </td>
        <td class="px-2 py-1">
          <input type="time" name="{{ key }}_end"
                 class="border border-gray-200 rounded px-2 py-1 text-xs w-full">
        </td>
      </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>

  <div class="pt-3 flex items-center gap-3">
    <button type="submit"
            class="px-6 py-2 rounded-full bg-pink-500 hover:bg-pink-600 text-white text-sm font-semibold shadow-sm">
      Save Doctor
    </button>
    <a href="{{ url_for('clinic_dashboard', tab='doctors') }}"
       class="text-sm text-gray-600 hover:text-gray-800">
      Cancel
    </a>
  </div>
</form>

<!-- Confirmation modal -->
<div id="doctor-save-modal"
     class="fixed inset-0 bg-black/30 hidden items-center justify-center z-50">
  <div class="bg-white rounded-2xl border border-pink-100 shadow-xl px-5 py-4 max-w-xs w-full text-center">
    <h2 class="text-sm font-semibold text-pink-700 mb-1">Add this doctor?</h2>
    <p class="text-xs text-gray-600 mb-4">
      This doctor profile will be added to your clinic dashboard.
    </p>
    <div class="flex justify-center gap-3 text-xs">
      <button id="doctor-save-confirm"
              class="px-4 py-1.5 rounded-full bg-pink-500 text-white hover:bg-pink-600">
        Save
      </button>
      <button id="doctor-save-cancel"
              class="px-4 py-1.5 rounded-full bg-gray-200 text-gray-700 hover:bg-gray-300">
        Cancel
      </button>
    </div>
  </div>
</div>

<script>
  let doctorSaveForm = null;

  function openDoctorSaveModal(form) {
      doctorSaveForm = form;
      const modal = document.getElementById('doctor-save-modal');
      modal.classList.remove('hidden');
      modal.classList.add('flex');
  }

  document.getElementById('doctor-save-confirm').onclick = function () {
      if (doctorSaveForm) {
          doctorSaveForm.submit();
      }
  };

  document.getElementById('doctor-save-cancel').onclick = function () {
      const modal = document.getElementById('doctor-save-modal');
      modal.classList.add('hidden');
      modal.classList.remove('flex');
      doctorSaveForm = null;
  };
</script>

{% endblock %}
